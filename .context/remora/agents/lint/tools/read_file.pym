from grail import Input

source_code: str = Input("source_code")
file_path: str = Input("file_path")
check_only: bool = Input("check_only", default=True)


def _line_count(content: str) -> int:
    if not content:
        return 0
    return len(content.splitlines())


try:
    if not source_code:
        raise ValueError("Source code is required.")
    
    line_count = _line_count(source_code)
    raw_result = {"content": source_code, "lines": line_count}
    result = {
        "result": raw_result,
        "summary": f"Read {line_count} lines from {file_path}",
        "knowledge_delta": {
            "last_read_file": file_path,
            "last_read_lines": line_count,
        },
        "outcome": "success",
    }
except Exception as exc:
    result = {
        "result": None,
        "summary": f"Error: {exc}",
        "knowledge_delta": {},
        "outcome": "error",
        "error": str(exc),
    }

result
